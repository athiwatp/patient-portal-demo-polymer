"use strict";window.PatientPortal=window.PatientPortal||{},window.PatientPortal.http=function(){function t(){var t=new Headers,n=localStorage.getItem("authToken");return n&&t.append("Authorization","Bearer "+n),t.append("content-type","application/json"),t}function n(n,e,o){return new Request(PatientPortal.config.apiUrl+"/"+e,{method:n,headers:t(),body:JSON.stringify(o)})}function e(t){if(t.ok)return t;if(401===t.status||403===t.status)return localStorage.removeItem("authToken"),void document.dispatchEvent(new CustomEvent("log-out",{bubbles:!0}));throw new Error("Things went horribly wrong",t)}return{get:function(t){return fetch(n("GET",t)).then(e).then(function(t){return t.json()})},post:function(t,o){return fetch(n("POST",t,o)).then(e).then(function(t){return t.json()})},put:function(t,o){return fetch(n("PUT",t,o)).then(e)},delete:function(t){return fetch(n("DELETE",t)).then(e).then(function(t){return t.json()})},login:function(t){return new Promise(function(n,e){fetch(PatientPortal.config.apiUrl+"/login",{method:"POST",body:JSON.stringify(t)}).then(function(t){if(t.headers.has("Authorization")){var o=t.headers.get("Authorization").substring(7);localStorage.setItem("authToken",o),n(o)}else e("Well that didn't work.")}).catch(function(t){return e(t)})})},logout:function(){localStorage.removeItem("authToken")}}}();