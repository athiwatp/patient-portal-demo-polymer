<html><head><link rel="import" href="../polymer/polymer.html">


<link rel="import" href="vaadin-grid-cell-click-behavior.html">

</head><body><dom-module id="vaadin-grid-table-cell"></dom-module>
<dom-module id="vaadin-grid-table-header-cell"></dom-module>
<dom-module id="vaadin-grid-table-footer-cell"></dom-module>
<dom-module id="vaadin-grid-sizer-cell"></dom-module>

<script>!function(){var e={properties:{column:Object,expanded:Boolean,flexGrow:Number,focused:{type:Boolean,reflectToAttribute:!0},frozen:{type:Boolean,reflectToAttribute:!0},lastFrozen:{type:Boolean,reflectToAttribute:!0},hidden:{type:Boolean,reflectToAttribute:!0},instance:Object,index:Number,item:Object,selected:Boolean,template:Object,target:Object,width:String,order:Number,reorderStatus:{type:String,reflectToAttribute:!0},_childColumns:Array,_cellContent:Object,_insertionPoint:Object,_templatizer:Object},observers:["_columnChanged(column)","_cellAttached(column, isAttached)","_expandedChanged(expanded, instance)","_flexGrowChanged(flexGrow)","_indexChanged(index, instance)","_itemChanged(item, instance)","_instanceChanged(instance, target)","_selectedChanged(selected, instance)","_toggleContent(isAttached, _cellContent, _insertionPoint)","_toggleInstance(isAttached, _templatizer, instance)","_widthChanged(width)","_orderChanged(order)","_visibleChildColumnsChanged(_visibleChildColumns)","_childColumnsChanged(_childColumns)"],created:function(){this.classList.add("vaadin-grid-cell")},_columnChanged:function(e){this.flexGrow=e.flexGrow,this.frozen=e.frozen,this.lastFrozen=e._lastFrozen,this.headerTemplate=e.headerTemplate,this.footerTemplate=e.footerTemplate,this.template=e.template,this.width=e.width,this.hidden=e.hidden,this.resizable=e.resizable,this._childColumns=e._childColumns,this.order=e._order,e.colSpan&&this.setAttribute("colspan",e.colSpan),this.listen(e,"property-changed","_columnPropChanged")},_cellAttached:function(e,t){t?this.listen(e,"property-changed","_columnPropChanged"):this.unlisten(e,"property-changed","_columnPropChanged")},_columnPropChanged:function(e){e.target==this.column&&("colSpan"===e.detail.path?this.setAttribute("colspan",e.detail.value):this[e.detail.path]=e.detail.value)},_expandedChanged:function(e,t){t.__expanded__=e,t.expanded=e},_flexGrowChanged:function(e){this.style.flexGrow=e},_indexChanged:function(e,t){t.index=e},_itemChanged:function(e,t){t.item=e},_selectedChanged:function(e,t){t.__selected__=e,t.selected=e},_childColumnsChanged:function(e){this.setAttribute("colspan",e.length)},_toggleContent:function(e,t,n){e?(Polymer.dom(t).parentNode!==this.target&&Polymer.dom(this.target).appendChild(t),Polymer.dom(this).appendChild(n)):this.debounce("remove-content",function(){this.isAttached||Polymer.dom(t).parentNode!==this.target||Polymer.dom(this.target).removeChild(t)},1)},_toggleInstance:function(e,t,n){e?t.addInstance(n):t.removeInstance(n)},_widthChanged:function(e){this.style.width=e},_orderChanged:function(e){this.style.order=e},_templateChanged:function(e){this.instance=e.templatizer.createInstance(),this._templatizer=e.templatizer},_instanceChanged:function(e,t){this.style.height="",this._cellContent=document.createElement("div"),this._cellContent.setAttribute("class","cell-content");var n=vaadin.elements.grid._contentIndex=vaadin.elements.grid._contentIndex+1||0;this._cellContent.setAttribute("data-cell-content-id",n),this._cellContent.setAttribute("id","vaadin-grid-cell-content-"+n),Polymer.dom(this._cellContent).appendChild(this.instance.root),this._insertionPoint=document.createElement("content"),this._insertionPoint.setAttribute("select",'[data-cell-content-id="'+n+'"]')}};Polymer({is:"vaadin-grid-table-cell",extends:"td",behaviors:[e,vaadin.elements.grid.CellClickBehavior],observers:["_templateChanged(template)"],_cellClick:function(){this.fire("cell-activate",{model:this.instance})}}),Polymer({is:"vaadin-grid-table-header-cell",extends:"th",properties:{headerTemplate:Object,resizable:Boolean,columnResizing:{type:Boolean,reflectToAttribute:!0}},behaviors:[e,vaadin.elements.grid.CellClickBehavior],observers:["_headerTemplateChanged(headerTemplate, isAttached)","_resizableChanged(resizable)"],listeners:{mousedown:"_cancelMouseDownOnResize",mousemove:"_enableDrag",mouseout:"_disableDrag",touchstart:"_onTouchStart",touchmove:"_onTouchMove",touchend:"_onTouchEnd",contextmenu:"_onContextMenu"},_onContextMenu:function(e){this._reorderGhost&&e.preventDefault()},_onTouchStart:function(e){e.target!==this._resizeHandle&&this.target.columnReorderingAllowed&&(this._startReorderTimeout=setTimeout(this._startReorder.bind(this,e),100))},_startReorder:function(e){this._reorderGhost=this._getGhost(),this._reorderGhost.style.visibility="visible";var t=new CustomEvent("dragstart",{bubbles:!0});this._cellContent.dispatchEvent(t),this._reorderXY={x:e.touches[0].clientX-this.getBoundingClientRect().left,y:e.touches[0].clientY-this.getBoundingClientRect().top},this._updateGhostPosition(e.touches[0].clientX,e.touches[0].clientY)},_onTouchMove:function(e){if(this._reorderGhost){e.preventDefault();var t=new CustomEvent("dragover",{bubbles:!0});t.clientX=e.touches[0].clientX,t.clientY=e.touches[0].clientY;var n=this._contentFromPoint(t.clientX,t.clientY);n&&n.dispatchEvent(t),this._updateGhostPosition(e.touches[0].clientX,e.touches[0].clientY)}else clearTimeout(this._startReorderTimeout)},_updateGhostPosition:function(e,t){var n=e-this._reorderXY.x,i=t-this._reorderXY.y-50,o=parseInt(this._reorderGhost.style.left||0),r=parseInt(this._reorderGhost.style.top||0),l=this._reorderGhost.getBoundingClientRect();this._reorderGhost.style.left=o-(l.left-n)+"px",this._reorderGhost.style.top=r-(l.top-i)+"px"},_onTouchEnd:function(e){if(clearTimeout(this._startReorderTimeout),this._reorderGhost){e.preventDefault();var t=new CustomEvent("dragend",{bubbles:!0});this.dispatchEvent(t),this._reorderGhost.style.visibility="hidden",this._reorderGhost=null}},_contentFromPoint:function(e,t){if(!Polymer.Settings.useShadow)return document.elementFromPoint(e,t);var n=this.target.$.scroller;n.toggleAttribute("no-content-pointer-events",!0);var i=n.root.elementFromPoint(e,t);return n.toggleAttribute("no-content-pointer-events",!1),i&&i.getContentChildren?i.getContentChildren("content")[0]:void 0},_getGhost:function(){var e=this.target.$.scroller.$.reorderghost;e.innerText=this._cellContent.innerText;var t=window.getComputedStyle(this._cellContent);return["boxSizing","display","width","height","background","alignItems","padding","border","flex-direction","overflow"].forEach(function(n){e.style[n]=t[n]},this),e},_enableDrag:function(){this._cellContent.draggable=this.target.columnReorderingAllowed&&!window.getSelection().toString()},_disableDrag:function(){this._cellContent.draggable=!1},_cancelMouseDownOnResize:function(e){e.target===this._resizeHandle&&e.preventDefault()},_resizableChanged:function(e){e?(this._resizeHandle=document.createElement("div"),this._resizeHandle.classList.add("vaadin-grid-column-resize-handle"),this.listen(this._resizeHandle,"track","_onTrack"),Polymer.dom(this).appendChild(this._resizeHandle)):this._resizeHandle&&(this.unlisten(this._resizeHandle,"track","_onTrack"),Polymer.dom(this).removeChild(this._resizeHandle))},_onTrack:function(e){this.columnResizing=!0;var t=this.column;"vaadin-grid-column-group"===t.localName&&(t=t._childColumns.slice(0).sort(function(e,t){return e._order-t._order}).filter(function(e){return!e.hidden}).pop());var n=this._getHeaderCellByColumn(t);if(n.offsetWidth){var i=window.getComputedStyle(n._cellContent),o=10+parseInt(i.paddingLeft)+parseInt(i.paddingRight);t.width=Math.max(o,n.offsetWidth+e.detail.x-n.getBoundingClientRect().right)+"px",t.flexGrow=0}var r=this.parentElement.parentElement;Polymer.dom(r).querySelectorAll("tr:last-child th").sort(function(e,t){return e.column._order-t.column._order}).forEach(function(e,t,i){t<i.indexOf(n)&&(e.column.width=e.offsetWidth+"px",e.column.flexGrow=0)}),this.columnResizing&&"end"===e.detail.state&&(this.columnResizing=!1),this.fire("column-resizing")},_getHeaderCellByColumn:function(e){var t=this.parentElement.parentElement;return Polymer.dom(t).querySelectorAll("tr:last-child th").filter(function(t){return t.column===e})[0]},_headerTemplateChanged:function(e,t){null===e||!this._isColumnRow&&"vaadin-grid-column-group"!==this.column.localName?(this._isEmpty=!0,this.instance=this.instance||{root:document.createElement("div")}):(this._isEmpty=!1,this.instance=this.instance||e.templatizer.createInstance(),this._templatizer=e.templatizer),t&&this.fire("cell-empty-changed")}}),Polymer({is:"vaadin-grid-table-footer-cell",extends:"td",properties:{footerTemplate:Object},behaviors:[e,vaadin.elements.grid.CellClickBehavior],observers:["_footerTemplateChanged(footerTemplate, isAttached)"],_footerTemplateChanged:function(e,t){null===e||!this._isColumnRow&&"vaadin-grid-column-group"!==this.column.localName?(this._isEmpty=!0,this.instance=this.instance||{root:document.createElement("div")}):(this._isEmpty=!1,this.instance=this.instance||e.templatizer.createInstance(),this._templatizer=e.templatizer),t&&this.fire("cell-empty-changed")}}),Polymer({is:"vaadin-grid-sizer-cell",behaviors:[e]})}();</script>
</body></html>